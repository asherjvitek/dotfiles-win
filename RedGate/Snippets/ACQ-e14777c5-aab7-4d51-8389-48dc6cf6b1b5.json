{
  "id": "e14777c5-aab7-4d51-8389-48dc6cf6b1b5",
  "prefix": "ACQ",
  "description": "All Client Query",
  "body": "DECLARE @Results TABLE\r\n    (\r\n      DBName VARCHAR(128),\r\n      LoanId INT\r\n    )\r\n\r\nDECLARE @SQLString VARCHAR(8000)\r\nSET @SQLString = '\r\nIF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N''[dbo].[loan_appl]'') AND type in (N''U''))\r\nBEGIN\r\n\tSELECT TOP 1\r\n\t\tDB_NAME(),\r\n\t\tla_loan_appl_id\r\n\tFROM\r\n\t\tloan_appl\r\nEND;'\r\n\r\n\r\nSET nocount ON\r\n\r\nUSE master\r\n\r\nDECLARE @DBNames TABLE (RowCounter INT IDENTITY, DBName VARCHAR(50))\r\n\r\nINSERT INTO @DBNames\r\n        SELECT\r\n            name\r\n        FROM\r\n            sysdatabases\r\n        WHERE\r\n            dbid > 4\r\n            AND name NOT IN ( 'scripterrors', 'PASCAdmin', 'dbamaint', 'PASolutions', 'PAReporting', 'PAMonitoring', 'CBReporting', 'distribution', 'Billing', 'PWBDefaultClient' )\r\n        ORDER BY\r\n            name\r\n\r\nDECLARE @NumDBs INT, @CurrentDB VARCHAR(50), @DBCounter INT, @Statement VARCHAR(8000)\r\n\r\nSET @NumDBs = @@rowcount\r\n\r\nSET @DBCounter = 1\r\n\r\nWHILE ( @DBCounter <= @NumDBs )\r\n    BEGIN\r\n        SELECT @CurrentDB = DBName\r\n        FROM @DBNames\r\n        WHERE RowCounter = @DBCounter\r\n        \r\n        SET @Statement = 'use [' + @CurrentDB + '] ' + @SQLString\r\n        \r\n        INSERT INTO @Results EXEC ( @Statement )\r\n        \r\n        SET @DBCounter = @DBCounter + 1\r\n    END\r\n\r\nSELECT * FROM @Results ORDER BY DBName"
}